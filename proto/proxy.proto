syntax = "proto3";

import "google/protobuf/empty.proto";

package proxy;

service Proxy {
  rpc SiteRejectEnabled (Enabled) returns (ProxyReply);
  rpc SiteMonitoringToggled (Site) returns (ProxyReply);
  rpc GetMitmStats (google.protobuf.Empty) returns (MitmStats);
}

message Site {
  string id = 1;
  bool enabled = 2;
}

message Enabled {
  bool enabled = 1;
}

message ProxyReply {
  int32 result = 1;
}

message MitmStats {
  int32 active_connections = 1;
  int32 peak_connections = 2;
  float rps = 3;
  float mem = 4;
  int32 dropped_flows = 5;
}